<?phpclass Controller_Link extends Controller_System{	public function before()	{		parent::before();	}		function action_index()	{		$id = (int)Arr::get($_GET, 'id');		$uid = (int)Arr::get($_GET, 'uid');		$listing_obj = DB::query(Database::SELECT, "SELECT listing->'third_party_url' as third_party_url, listing->'selling_option' AS selling_option FROM listing_data ld WHERE (listing->'user_id')::integer = :uid AND ld.listing_id = :id")		->param(':uid', $uid)		->param(':id', $id)		->execute();		if (count($listing_obj) > 0)		{			$selling_option = $listing_obj[0]['selling_option'];			$third_party_url = $listing_obj[0]['third_party_url'];			if ($third_party_url != '' AND $selling_option & 2 > 0)			{				Request::current()->redirect($third_party_url);			}			else			{				Request::current()->redirect('/');			}		}		else		{			Request::current()->redirect('/');		}								}}?>